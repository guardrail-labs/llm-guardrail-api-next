policy_version: "pii-redact-1"
rules:
  redact:
    - id: pii.email
      pattern: "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}\\b"
    - id: pii.phone_us
      # +1 (555) 123-4567, 555-123-4567, 5551234567
      pattern: "\\b(?:\\+?1[\\s.-]?)?(?:\\(?\\d{3}\\)?[\\s.-]?){2}\\d{4}\\b"
    - id: pii.ssn_us
      # basic U.S. SSN with simple invalid-range guards
      pattern: "\\b(?!000|666|9\\d\\d)\\d{3}[- ]?(?!00)\\d{2}[- ]?(?!0000)\\d{4}\\b"
    - id: pii.credit_card
      # Visa/MasterCard/Amex basic formats (no Luhn hereâ€”fast path)
      pattern: "\\b(?:4\\d{3}|5[1-5]\\d{2}|3[47]\\d{2})[- ]?\\d{4}[- ]?\\d{4}(?:[- ]?\\d{3,4})?\\b"
