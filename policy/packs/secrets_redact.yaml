policy_version: "secrets-redact-2"
rules:
  redact:
    - id: secret.jwt
      pattern: '\beyJ[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}\.[a-zA-Z0-9_-]{10,}\b'

    - id: secret.aws_access_key
      pattern: '\bAKIA[0-9A-Z]{16}\b'

    - id: secret.aws_temp_key
      pattern: '\bASIA[0-9A-Z]{16}\b'

    - id: secret.generic_token
      pattern: '\b(?:token|api|key|secret)[-_][A-Za-z0-9]{20,}\b'

    - id: secret.openai_style
      pattern: '\bsk-[A-Za-z0-9]{32,}\b'

    - id: secret.github_pat_classic
      pattern: '\bghp_[A-Za-z0-9]{36}\b'

    - id: secret.github_pat_other
      pattern: '\bgh[ous]_[A-Za-z0-9]{36}\b'

    - id: secret.github_pat_fine
      pattern: '\bgithub_pat_[0-9A-Za-z_]{22,}\b'

    - id: secret.gitlab_pat
      pattern: '\bglpat-[A-Za-z0-9_-]{20,}\b'

    - id: secret.slack_token
      pattern: '\bxox[abprs]-[A-Za-z0-9-]{10,}\b'

    - id: secret.slack_webhook
      pattern: '\bhttps://hooks\.slack\.com/services/[A-Z0-9]{8,}/[A-Z0-9]{8,}/[A-Za-z0-9]{24,}\b'

    - id: secret.discord_webhook
      pattern: '\bhttps://discord(?:app)?\.com/api/webhooks/\d{6,}/[A-Za-z0-9._-]{20,}\b'

    - id: secret.stripe_key
      pattern: '\bsk_(?:live|test)_[0-9A-Za-z]{24,}\b'

    - id: secret.twilio_sid
      pattern: '\bAC[0-9a-fA-F]{32}\b'

    - id: secret.twilio_auth_token
      pattern: '(?i)(?:twilio|auth[_-]?token)[''":=\s]+[0-9a-fA-F]{32}\b'

    - id: secret.google_api_key
      pattern: '\bAIza[0-9A-Za-z\-_]{35}\b'

    - id: secret.gcp_private_key_block
      pattern: '-----BEGIN PRIVATE KEY-----[\s\S]+?-----END PRIVATE KEY-----'

    - id: secret.aws_secret_access_key
      pattern: '(?i)(?:aws[_-]?secret(?:[_-]?access)?[_-]?key|aws[_-]?secret)[''":=\s]+([A-Za-z0-9/+]{40})\b'
