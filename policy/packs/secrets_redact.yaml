policy_version: "secrets-redact-1"
rules:
  redact:
    - id: secret.jwt
      # three base64url segments, minimally sized
      pattern: "\\beyJ[a-zA-Z0-9_-]{10,}\\.[a-zA-Z0-9_-]{10,}\\.[a-zA-Z0-9_-]{10,}\\b"
    - id: secret.aws_access_key
      pattern: "\\bAKIA[0-9A-Z]{16}\\b"
    - id: secret.aws_temp_key
      pattern: "\\bASIA[0-9A-Z]{16}\\b"
    - id: secret.generic_token
      # generic tokens like token_xxx / api_xxx / key_xxx etc.
      pattern: "\\b(?:token|api|key|secret)[-_][A-Za-z0-9]{20,}\\b"
    - id: secret.openai_style
      pattern: "\\bsk-[A-Za-z0-9]{32,}\\b"
