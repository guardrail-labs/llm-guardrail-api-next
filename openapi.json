{
  "openapi": "3.1.0",
  "info": {
    "title": "LLM Guardrail API",
    "description": "Policy enforcement, adjudication, and observability for LLM apps.",
    "contact": {
      "name": "Guardrail Team"
    },
    "license": {
      "name": "Apache-2.0"
    },
    "version": "1.0.0"
  },
  "paths": {
    "/livez": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Livez",
        "operationId": "livez_livez_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/readyz": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Readyz",
        "operationId": "readyz_readyz_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/health": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Health Alias",
        "operationId": "health_alias_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/healthz": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Healthz",
        "operationId": "healthz_healthz_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/api/scope/effective": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Effective Scope",
        "description": "Returns the caller's effective scope as JSON and sets X-Effective-* headers.",
        "operationId": "get_effective_scope_admin_api_scope_effective_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EffectiveScope"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/scope/bindings": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Bindings",
        "description": "Read-only: policy pack bindings and mitigation overrides for a specific\ntenant/bot.",
        "operationId": "get_bindings_admin_api_scope_bindings_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Tenant id (required)",
              "title": "Tenant"
            },
            "description": "Tenant id (required)"
          },
          {
            "name": "bot",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Bot id (required)",
              "title": "Bot"
            },
            "description": "Bot id (required)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BindingsResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/scope/secrets": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Secret Sets",
        "description": "Read-only: list **names** of secret sets available to tenant/bot (no values).",
        "operationId": "get_secret_sets_admin_api_scope_secrets_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Tenant id (required)",
              "title": "Tenant"
            },
            "description": "Tenant id (required)"
          },
          {
            "name": "bot",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Bot id (required)",
              "title": "Bot"
            },
            "description": "Bot id (required)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SecretsResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/policy/packs": {
      "get": {
        "summary": "Api Packs",
        "operationId": "api_packs_admin_api_policy_packs_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PackList"
                }
              }
            }
          }
        }
      }
    },
    "/admin/policy/packs": {
      "get": {
        "summary": "Ui Packs",
        "operationId": "ui_packs_admin_policy_packs_get",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Search id/source",
              "title": "Q"
            },
            "description": "Search id/source"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/idempotency/recent": {
      "get": {
        "tags": [
          "Admin / Idempotency"
        ],
        "summary": "List Recent",
        "operationId": "list_recent_admin_idempotency_recent_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Tenant identifier",
              "title": "Tenant"
            },
            "description": "Tenant identifier"
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "description": "Maximum entries to return",
              "default": 50,
              "title": "Limit"
            },
            "description": "Maximum entries to return"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "title": "Response List Recent Admin Idempotency Recent Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/idempotency/{key}": {
      "get": {
        "tags": [
          "Admin / Idempotency"
        ],
        "summary": "Inspect Key",
        "operationId": "inspect_key_admin_idempotency__key__get",
        "parameters": [
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Key"
            }
          },
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Tenant identifier",
              "title": "Tenant"
            },
            "description": "Tenant identifier"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Inspect Key Admin Idempotency  Key  Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "Admin / Idempotency"
        ],
        "summary": "Purge Key",
        "operationId": "purge_key_admin_idempotency__key__delete",
        "parameters": [
          {
            "name": "key",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Key"
            }
          },
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Tenant identifier",
              "title": "Tenant"
            },
            "description": "Tenant identifier"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Purge Key Admin Idempotency  Key  Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/decisions": {
      "get": {
        "tags": [
          "decisions"
        ],
        "summary": "List decisions (cursor)",
        "description": "Cursor-paginated decisions ordered by (ts desc, id). Supports filters for tenant, bot, since (epoch ms), outcome, and request_id.",
        "operationId": "get_decisions_admin_api_decisions_get",
        "parameters": [
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter decisions since this ISO8601 timestamp (UTC)",
              "examples": [
                {
                  "summary": "Recent decisions",
                  "value": "2024-01-01T00:00:00Z"
                }
              ],
              "title": "Since"
            },
            "description": "Filter decisions since this ISO8601 timestamp (UTC)"
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by outcome",
              "examples": [
                {
                  "summary": "Allow outcome",
                  "value": "allow"
                }
              ],
              "title": "Outcome"
            },
            "description": "Filter by outcome"
          },
          {
            "name": "request_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Return decisions for a specific request ID",
              "examples": [
                {
                  "summary": "Specific request",
                  "value": "req-123"
                }
              ],
              "title": "Request Id"
            },
            "description": "Return decisions for a specific request ID"
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "1-based page number (ignored when limit/offset query params are provided)",
              "default": 1,
              "title": "Page"
            },
            "description": "1-based page number (ignored when limit/offset query params are provided)"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "description": "Items per page when using page/page_size (overridden by limit/offset)",
              "default": 50,
              "title": "Page Size"
            },
            "description": "Items per page when using page/page_size (overridden by limit/offset)"
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "ts",
              "title": "Sort"
            }
          },
          {
            "name": "sort_dir",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sort Dir"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "description": "Maximum number of items to return when using cursor pagination",
              "examples": [
                {
                  "summary": "Custom page size",
                  "value": 100
                }
              ],
              "default": 50,
              "title": "Limit"
            },
            "description": "Maximum number of items to return when using cursor pagination"
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Opaque cursor token from a previous response",
              "examples": [
                {
                  "summary": "Resume token",
                  "value": "1704067200000:dec_42"
                }
              ],
              "title": "Cursor"
            },
            "description": "Opaque cursor token from a previous response"
          },
          {
            "name": "cursor_dir",
            "in": "query",
            "required": false,
            "schema": {
              "enum": [
                "next",
                "prev"
              ],
              "type": "string",
              "description": "Direction relative to the provided cursor",
              "examples": [
                {
                  "summary": "Previous page",
                  "value": "prev"
                }
              ],
              "default": "next",
              "title": "Cursor Dir"
            },
            "description": "Direction relative to the provided cursor"
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Offset to use with limit when cursor is not supplied",
              "examples": [
                {
                  "summary": "First page",
                  "value": 0
                }
              ],
              "title": "Offset"
            },
            "description": "Offset to use with limit when cursor is not supplied"
          }
        ],
        "responses": {
          "200": {
            "description": "Decisions with cursor metadata.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecisionPage"
                },
                "example": {
                  "items": [
                    {
                      "id": "dec_123",
                      "ts": "2024-01-01T12:00:00Z",
                      "tenant": "tenant-123",
                      "bot": "bot-alpha",
                      "outcome": "allow",
                      "policy_version": "v1",
                      "rule_id": "rule-42",
                      "mode": "enforce",
                      "details": {
                        "score": 0.12
                      }
                    }
                  ],
                  "limit": 50,
                  "dir": "next",
                  "next_cursor": "1704100800000:dec_123",
                  "total": 120
                }
              }
            }
          },
          "401": {
            "description": "Authentication required."
          },
          "403": {
            "description": "Forbidden for the provided scope."
          },
          "429": {
            "description": "Too many requests."
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/decisions": {
      "get": {
        "summary": "Decisions Page",
        "operationId": "decisions_page_admin_decisions_get",
        "parameters": [
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since"
            }
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Outcome"
            }
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "description": "1-based page number (ignored when limit/offset query params are provided)",
              "default": 1,
              "title": "Page"
            },
            "description": "1-based page number (ignored when limit/offset query params are provided)"
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "description": "Items per page when using page/page_size (overridden by limit/offset)",
              "default": 50,
              "title": "Page Size"
            },
            "description": "Items per page when using page/page_size (overridden by limit/offset)"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/decisions/export": {
      "get": {
        "tags": [
          "decisions"
        ],
        "summary": "Export decisions",
        "description": "Stream decisions as CSV or newline-delimited JSON (NDJSON).",
        "operationId": "export_decisions_admin_api_decisions_export_get",
        "parameters": [
          {
            "name": "format",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(csv|jsonl)$",
              "default": "csv",
              "title": "Format"
            }
          },
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "ISO8601 timestamp (UTC)",
              "title": "Since"
            },
            "description": "ISO8601 timestamp (UTC)"
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Outcome"
            }
          },
          {
            "name": "batch",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 10000,
              "minimum": 100,
              "default": 1000,
              "title": "Batch"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Decision export stream.",
            "content": {
              "application/json": {
                "schema": {}
              },
              "text/csv": {
                "example": "id,ts,outcome\ndec_123,2024-01-01T12:00:00Z,allow"
              },
              "application/x-ndjson": {
                "example": "{\"id\":\"dec_123\",\"tenant\":\"tenant-123\"}\n"
              }
            }
          },
          "401": {
            "description": "Authentication required."
          },
          "403": {
            "description": "Forbidden for the provided scope."
          },
          "429": {
            "description": "Too many requests."
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/decisions/export.csv": {
      "get": {
        "summary": "Export Csv",
        "operationId": "export_csv_admin_api_decisions_export_csv_get",
        "parameters": [
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Since"
            }
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Outcome"
            }
          },
          {
            "name": "page_size",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 5000,
              "minimum": 100,
              "default": 1000,
              "title": "Page Size"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Index",
        "operationId": "admin_index_admin_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/policy/current": {
      "get": {
        "summary": "Policy Current",
        "operationId": "policy_current_admin_policy_current_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings/apply_demo_defaults": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Apply Demo Defaults",
        "operationId": "apply_demo_defaults_admin_bindings_apply_demo_defaults_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Apply Demo Defaults Admin Bindings Apply Demo Defaults Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings/apply_golden": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Apply Golden Packs",
        "operationId": "apply_golden_packs_admin_bindings_apply_golden_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Apply Golden Packs Admin Bindings Apply Golden Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings/apply_strict_secrets": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Apply Strict Secrets",
        "operationId": "apply_strict_secrets_admin_bindings_apply_strict_secrets_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Apply Strict Secrets Admin Bindings Apply Strict Secrets Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/secrets/strict": {
      "get": {
        "tags": [
          "admin-secrets"
        ],
        "summary": "Get Strict",
        "operationId": "get_strict_admin_api_secrets_strict_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StrictResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin-secrets"
        ],
        "summary": "Set Strict",
        "operationId": "set_strict_admin_api_secrets_strict_put",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StrictSetReq"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/app__routes__admin_secrets_strict__OkResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/audit/recent": {
      "get": {
        "tags": [
          "admin-audit"
        ],
        "summary": "Recent Audit",
        "operationId": "recent_audit_admin_api_audit_recent_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "default": 20,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AuditItem"
                  },
                  "title": "Response Recent Audit Admin Api Audit Recent Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/audit/export": {
      "get": {
        "tags": [
          "admin:audit"
        ],
        "summary": "Export Audit",
        "operationId": "export_audit_admin_audit_export_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "title": "Tenant"
            }
          },
          {
            "name": "incident_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Incident Id"
            }
          },
          {
            "name": "start",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Start"
            }
          },
          {
            "name": "end",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "End"
            }
          },
          {
            "name": "fmt",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "pattern": "^(json|csv)$",
              "default": "json",
              "title": "Fmt"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "title": "Response Export Audit Admin Audit Export Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/audit/export.ndjson": {
      "get": {
        "tags": [
          "admin-audit"
        ],
        "summary": "Export Audit Ndjson",
        "description": "Stream admin audit events as NDJSON.",
        "operationId": "export_audit_ndjson_admin_api_audit_export_ndjson_get",
        "parameters": [
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch ms inclusive",
              "title": "Since"
            },
            "description": "Epoch ms inclusive"
          },
          {
            "name": "until",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch ms inclusive",
              "title": "Until"
            },
            "description": "Epoch ms inclusive"
          },
          {
            "name": "action",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Action"
            }
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string",
                  "pattern": "^(ok|error)$"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Outcome"
            }
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/data/export.ndjson": {
      "get": {
        "tags": [
          "admin-data"
        ],
        "summary": "Export Ndjson",
        "operationId": "export_ndjson_admin_api_data_export_ndjson_get",
        "parameters": [
          {
            "name": "kinds",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Comma-separated kinds: decisions,adjudications,audit",
              "title": "Kinds"
            },
            "description": "Comma-separated kinds: decisions,adjudications,audit"
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch milliseconds inclusive",
              "title": "Since"
            },
            "description": "Epoch milliseconds inclusive"
          },
          {
            "name": "until",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch milliseconds inclusive",
              "title": "Until"
            },
            "description": "Epoch milliseconds inclusive"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/data/delete": {
      "post": {
        "tags": [
          "admin-data"
        ],
        "summary": "Delete Data",
        "operationId": "delete_data_admin_api_data_delete_post",
        "parameters": [
          {
            "name": "X-CSRF-Token",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Csrf-Token"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DeleteRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DeleteResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/features": {
      "get": {
        "tags": [
          "admin-features"
        ],
        "summary": "Get Features",
        "operationId": "get_features_admin_api_features_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/FeaturesResp"
                }
              }
            }
          }
        }
      }
    },
    "/admin/auth/login": {
      "get": {
        "tags": [
          "admin-auth"
        ],
        "summary": "Login",
        "operationId": "login_admin_auth_login_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/auth/callback": {
      "get": {
        "tags": [
          "admin-auth"
        ],
        "summary": "Callback",
        "operationId": "callback_admin_auth_callback_get",
        "parameters": [
          {
            "name": "code",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Code"
            }
          },
          {
            "name": "state",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "State"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/auth/logout": {
      "post": {
        "tags": [
          "admin-auth"
        ],
        "summary": "Logout",
        "operationId": "logout_admin_auth_logout_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/api/me": {
      "get": {
        "tags": [
          "admin-auth"
        ],
        "summary": "Me",
        "operationId": "me_admin_api_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MeResp"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Bindings",
        "operationId": "get_bindings_admin_bindings_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Bindings Admin Bindings Get"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin"
        ],
        "summary": "Put Bindings",
        "operationId": "put_bindings_admin_bindings_put",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true,
                "title": "Payload"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Put Bindings Admin Bindings Put"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin"
        ],
        "summary": "Delete Bindings",
        "operationId": "delete_bindings_admin_bindings_delete",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Delete Bindings Admin Bindings Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/policy/version": {
      "get": {
        "summary": "Policy Version",
        "operationId": "policy_version_policy_version_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/policy/reload": {
      "post": {
        "summary": "Policy Reload",
        "operationId": "policy_reload_admin_policy_reload_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Policy Reload Admin Policy Reload Post"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings/resolve": {
      "get": {
        "summary": "Bindings Resolve",
        "description": "Introspect which rules pack is active for a given (tenant, bot).\nReturns the resolved rules_path and current policy_version.\nHonors optional admin auth via X-Admin-Key if ADMIN_API_KEY is set.",
        "operationId": "bindings_resolve_admin_bindings_resolve_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "default",
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "default",
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/decisions.ndjson": {
      "get": {
        "tags": [
          "admin-decisions"
        ],
        "summary": "Export Decisions Ndjson",
        "operationId": "export_decisions_ndjson_admin_decisions_ndjson_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "rule_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Rule Id"
            }
          },
          {
            "name": "request_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Request Id"
            }
          },
          {
            "name": "decision",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Decision"
            }
          },
          {
            "name": "from_ts",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "From Ts"
            }
          },
          {
            "name": "to_ts",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "To Ts"
            }
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sort"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/decisions/export.csv": {
      "get": {
        "tags": [
          "admin-decisions"
        ],
        "summary": "Export Decisions Csv",
        "operationId": "export_decisions_csv_admin_decisions_export_csv_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/decisions/stream": {
      "get": {
        "tags": [
          "admin-decisions"
        ],
        "summary": "Stream Decisions",
        "operationId": "stream_decisions_admin_decisions_stream_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/policies/active": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Active Policy",
        "operationId": "get_active_policy_admin_policies_active_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/policies/preview": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Preview Policy",
        "description": "Dry-run preview of active policy with overrides; does NOT persist changes.\nBody example:\n  { \"env_overrides\": { \"EGRESS_SUMMARIZE_ENABLED\": \"1\", \"CLARIFY_HTTP_STATUS\": \"400\" } }",
        "operationId": "preview_policy_admin_policies_preview_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Proposed"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/rulepacks": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Rulepacks Index",
        "operationId": "rulepacks_index_admin_rulepacks_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/rulepacks/{name}": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Rulepack Detail",
        "operationId": "rulepack_detail_admin_rulepacks__name__get",
        "parameters": [
          {
            "name": "name",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Name"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Overview",
        "operationId": "ui_overview_admin_ui_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/bindings": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Bindings",
        "operationId": "ui_bindings_admin_ui_bindings_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/bindings/data": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Bindings Data",
        "operationId": "ui_bindings_data_admin_ui_bindings_data_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/ui/decisions": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Decisions",
        "operationId": "ui_decisions_admin_ui_decisions_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/adjudications": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Adjudications",
        "operationId": "ui_adjudications_admin_ui_adjudications_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/config": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Config",
        "operationId": "ui_config_admin_ui_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/config/history": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Config History",
        "operationId": "ui_config_history_admin_ui_config_history_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Webhooks",
        "operationId": "ui_webhooks_admin_webhooks_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/webhooks": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Webhooks",
        "operationId": "ui_webhooks_admin_ui_webhooks_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/policy": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Policy Page",
        "description": "Render Policy admin page with active version and configured packs.",
        "operationId": "policy_page_admin_policy_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/reload": {
      "post": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Reload",
        "operationId": "ui_reload_admin_ui_reload_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/Body_ui_reload_admin_ui_reload_post"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/export/decisions": {
      "get": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Export Decisions",
        "operationId": "export_decisions_admin_ui_export_decisions_get",
        "parameters": [
          {
            "name": "n",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 1000,
              "title": "N"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/bindings/apply_golden": {
      "post": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Apply Golden",
        "operationId": "ui_apply_golden_admin_ui_bindings_apply_golden_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/bindings/apply_strict_secrets": {
      "post": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Apply Strict Secrets",
        "operationId": "ui_apply_strict_secrets_admin_ui_bindings_apply_strict_secrets_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/ui/bindings/apply_demo_defaults": {
      "post": {
        "tags": [
          "admin-ui"
        ],
        "summary": "Ui Apply Demo Defaults",
        "operationId": "ui_apply_demo_defaults_admin_ui_bindings_apply_demo_defaults_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/config": {
      "get": {
        "tags": [
          "admin-config"
        ],
        "summary": "Get Cfg",
        "operationId": "get_cfg_admin_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin-config"
        ],
        "summary": "Update Runtime Config",
        "description": "Accept JSON or form POST to update runtime configuration, with CSRF equality check.\n\n- JSON:\n  Content-Type: application/json; body contains keys and optional \"csrf_token\".\n- Form:\n  application/x-www-form-urlencoded or multipart/form-data; we read a \"csrf_token\"\n  field and additional key/value fields to update.",
        "operationId": "update_runtime_config_admin_config_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/config/versions": {
      "get": {
        "tags": [
          "admin-config"
        ],
        "summary": "List Versions",
        "operationId": "list_versions_admin_config_versions_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 100,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/config/rollback": {
      "post": {
        "tags": [
          "admin-config"
        ],
        "summary": "Rollback Config",
        "operationId": "rollback_config_admin_config_rollback_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/webhook/config": {
      "get": {
        "tags": [
          "admin-webhook"
        ],
        "summary": "Get Webhook Cfg",
        "operationId": "get_webhook_cfg_admin_webhook_config_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin-webhook"
        ],
        "summary": "Set Webhook Cfg",
        "operationId": "set_webhook_cfg_admin_webhook_config_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/webhook/test": {
      "post": {
        "tags": [
          "admin-webhook"
        ],
        "summary": "Webhook Test",
        "operationId": "webhook_test_admin_webhook_test_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/pending": {
      "get": {
        "tags": [
          "admin-webhook-dlq"
        ],
        "summary": "List Pending Dlq",
        "operationId": "list_pending_dlq_admin_webhooks_dlq_pending_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "topic",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Topic"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "default": 100,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response List Pending Dlq Admin Webhooks Dlq Pending Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/quarantine": {
      "get": {
        "tags": [
          "admin-webhook-dlq"
        ],
        "summary": "List Quarantine Dlq",
        "operationId": "list_quarantine_dlq_admin_webhooks_dlq_quarantine_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "topic",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Topic"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "default": 200,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response List Quarantine Dlq Admin Webhooks Dlq Quarantine Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/{msg_id}/replay": {
      "post": {
        "tags": [
          "admin-webhook-dlq"
        ],
        "summary": "Replay Message",
        "operationId": "replay_message_admin_webhooks_dlq__msg_id__replay_post",
        "parameters": [
          {
            "name": "msg_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Msg Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Replay Message Admin Webhooks Dlq  Msg Id  Replay Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/{msg_id}": {
      "delete": {
        "tags": [
          "admin-webhook-dlq"
        ],
        "summary": "Delete Message",
        "operationId": "delete_message_admin_webhooks_dlq__msg_id__delete",
        "parameters": [
          {
            "name": "msg_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Msg Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  },
                  "title": "Response Delete Message Admin Webhooks Dlq  Msg Id  Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/webhooks/status": {
      "get": {
        "summary": "Webhooks Status",
        "operationId": "webhooks_status_admin_api_webhooks_status_get",
        "parameters": [
          {
            "name": "peek",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 0,
              "default": 0,
              "title": "Peek"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/webhooks/replay": {
      "post": {
        "summary": "Webhooks Replay",
        "operationId": "webhooks_replay_admin_api_webhooks_replay_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/fastapi___compat__v2__Body_webhooks_replay_admin_api_webhooks_replay_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/peek": {
      "get": {
        "summary": "Admin Webhooks Dlq Peek",
        "operationId": "admin_webhooks_dlq_peek_admin_webhooks_dlq_peek_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 200,
              "minimum": 1,
              "default": 20,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "title": "Response Admin Webhooks Dlq Peek Admin Webhooks Dlq Peek Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/replay": {
      "post": {
        "summary": "Admin Webhooks Dlq Replay",
        "operationId": "admin_webhooks_dlq_replay_admin_webhooks_dlq_replay_post",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 1000,
              "minimum": 1,
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "integer"
                  },
                  "title": "Response Admin Webhooks Dlq Replay Admin Webhooks Dlq Replay Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/webhooks/dlq/purge": {
      "delete": {
        "summary": "Admin Webhooks Dlq Purge",
        "operationId": "admin_webhooks_dlq_purge_admin_webhooks_dlq_purge_delete",
        "parameters": [
          {
            "name": "older_than_s",
            "in": "query",
            "required": true,
            "schema": {
              "type": "number",
              "exclusiveMinimum": 0.0,
              "title": "Older Than S"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "integer"
                  },
                  "title": "Response Admin Webhooks Dlq Purge Admin Webhooks Dlq Purge Delete"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/webhooks/dlq": {
      "get": {
        "tags": [
          "admin-webhooks"
        ],
        "summary": "Get Dlq",
        "operationId": "get_dlq_admin_api_webhooks_dlq_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DlqStats"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/webhooks/dlq/retry": {
      "post": {
        "tags": [
          "admin-webhooks"
        ],
        "summary": "Retry Dlq",
        "operationId": "retry_dlq_admin_api_webhooks_dlq_retry_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DlqActionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DlqActResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/webhooks/dlq/purge": {
      "post": {
        "tags": [
          "admin-webhooks"
        ],
        "summary": "Purge Dlq",
        "operationId": "purge_dlq_admin_api_webhooks_dlq_purge_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DlqActionRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DlqActResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/echo": {
      "get": {
        "summary": "Admin Echo",
        "description": "Admin-only echo endpoint used for smoke and demos.\n\nThis response passes through the egress redaction middleware, so any configured\npolicy packs (e.g., PII/Secrets) will redact content in the echoed text.",
        "operationId": "admin_echo_admin_echo_get",
        "parameters": [
          {
            "name": "text",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Text to echo back",
              "title": "Text"
            },
            "description": "Text to echo back"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/metrics/mitigation-overrides": {
      "get": {
        "tags": [
          "admin-metrics"
        ],
        "summary": "Get Mitigation Overrides",
        "description": "Return aggregated guardrail mitigation override counters across multiprocess collector.",
        "operationId": "get_mitigation_overrides_admin_api_metrics_mitigation_overrides_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OverridesResp"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/tokens": {
      "get": {
        "tags": [
          "admin-tokens"
        ],
        "summary": "List Tokens",
        "operationId": "list_tokens_admin_api_tokens_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response List Tokens Admin Api Tokens Get"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/tokens/mint": {
      "post": {
        "tags": [
          "admin-tokens"
        ],
        "summary": "Mint Token",
        "operationId": "mint_token_admin_api_tokens_mint_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Mint Token Admin Api Tokens Mint Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/tokens/revoke": {
      "post": {
        "tags": [
          "admin-tokens"
        ],
        "summary": "Revoke Token",
        "operationId": "revoke_token_admin_api_tokens_revoke_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Revoke Token Admin Api Tokens Revoke Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/adjudications": {
      "get": {
        "summary": "List Adjudications",
        "operationId": "list_adjudications_admin_adjudications_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "provider",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Provider"
            }
          },
          {
            "name": "request_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Request Id"
            }
          },
          {
            "name": "rule_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Rule Id"
            }
          },
          {
            "name": "decision",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Decision"
            }
          },
          {
            "name": "mitigation_forced",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Mitigation Forced"
            }
          },
          {
            "name": "start",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Start"
            }
          },
          {
            "name": "end",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "End"
            }
          },
          {
            "name": "from_ts",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "From Ts"
            }
          },
          {
            "name": "to_ts",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "To Ts"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Limit"
            }
          },
          {
            "name": "offset",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Offset"
            }
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sort"
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Cursor"
            }
          },
          {
            "name": "dir",
            "in": "query",
            "required": false,
            "schema": {
              "enum": [
                "next",
                "prev"
              ],
              "type": "string",
              "default": "next",
              "title": "Dir"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/adjudications.ndjson": {
      "get": {
        "summary": "Export Adjudications",
        "operationId": "export_adjudications_admin_adjudications_ndjson_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "provider",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Provider"
            }
          },
          {
            "name": "request_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Request Id"
            }
          },
          {
            "name": "rule_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Rule Id"
            }
          },
          {
            "name": "decision",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Decision"
            }
          },
          {
            "name": "mitigation_forced",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Mitigation Forced"
            }
          },
          {
            "name": "start",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Start"
            }
          },
          {
            "name": "end",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "End"
            }
          },
          {
            "name": "from_ts",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "From Ts"
            }
          },
          {
            "name": "to_ts",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "To Ts"
            }
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Sort"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/adjudications": {
      "get": {
        "tags": [
          "adjudications",
          "adjudications"
        ],
        "summary": "List adjudications (cursor)",
        "description": "Cursor-paginated adjudications ordered by (ts desc, id). Supports filters for tenant, bot, since (epoch ms), outcome, rule_id, and request_id.",
        "operationId": "list_adjudications_admin_api_adjudications_get",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 500,
              "minimum": 1,
              "description": "Maximum number of adjudications to include in the response",
              "examples": [
                {
                  "summary": "Custom page size",
                  "value": 100
                }
              ],
              "default": 50,
              "title": "Limit"
            },
            "description": "Maximum number of adjudications to include in the response"
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Opaque cursor token from a previous response",
              "examples": [
                {
                  "summary": "Resume token",
                  "value": "1704067200000:adj_7"
                }
              ],
              "title": "Cursor"
            },
            "description": "Opaque cursor token from a previous response"
          },
          {
            "name": "dir",
            "in": "query",
            "required": false,
            "schema": {
              "enum": [
                "next",
                "prev"
              ],
              "type": "string",
              "description": "Direction relative to the provided cursor",
              "examples": [
                {
                  "summary": "Previous page",
                  "value": "prev"
                }
              ],
              "default": "next",
              "title": "Dir"
            },
            "description": "Direction relative to the provided cursor"
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          },
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Return adjudications at or after this epoch millisecond timestamp",
              "examples": [
                {
                  "summary": "Recent adjudications",
                  "value": 1704067200000
                }
              ],
              "title": "Since"
            },
            "description": "Return adjudications at or after this epoch millisecond timestamp"
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by adjudication outcome",
              "examples": [
                {
                  "summary": "Allow outcome",
                  "value": "allow"
                }
              ],
              "title": "Outcome"
            },
            "description": "Filter by adjudication outcome"
          },
          {
            "name": "rule_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Filter by rule identifier",
              "examples": [
                {
                  "summary": "Rule identifier",
                  "value": "rule-1"
                }
              ],
              "title": "Rule Id"
            },
            "description": "Filter by rule identifier"
          },
          {
            "name": "request_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Return adjudications for a specific request ID",
              "examples": [
                {
                  "summary": "Specific request",
                  "value": "req-123"
                }
              ],
              "title": "Request Id"
            },
            "description": "Return adjudications for a specific request ID"
          }
        ],
        "responses": {
          "200": {
            "description": "Adjudications with cursor metadata.",
            "content": {
              "application/json": {
                "schema": {},
                "example": {
                  "items": [
                    {
                      "id": "adj_7",
                      "ts": "2024-01-01T12:00:00Z",
                      "tenant": "tenant-123",
                      "bot": "bot-alpha",
                      "outcome": "allow",
                      "rule_id": "rule-1",
                      "request_id": "req-123"
                    }
                  ],
                  "limit": 50,
                  "dir": "next",
                  "next_cursor": "1704100800000:adj_7"
                }
              }
            }
          },
          "401": {
            "description": "Authentication required."
          },
          "403": {
            "description": "Forbidden for the provided scope."
          },
          "429": {
            "description": "Too many requests."
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/retention/preview": {
      "post": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Retention Preview",
        "operationId": "retention_preview_admin_api_retention_preview_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PreviewReq"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PreviewResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/retention/execute": {
      "post": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Retention Execute",
        "operationId": "retention_execute_admin_api_retention_execute_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ExecuteReq"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ExecuteResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/retention/policies": {
      "get": {
        "tags": [
          "admin-retention"
        ],
        "summary": "List Policies Admin",
        "operationId": "list_policies_admin_admin_retention_policies_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response List Policies Admin Admin Retention Policies Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Upsert Policy Admin",
        "operationId": "upsert_policy_admin_admin_retention_policies_put",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PolicyPayload"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Upsert Policy Admin Admin Retention Policies Put"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/retention/plan": {
      "post": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Plan Purge Admin",
        "operationId": "plan_purge_admin_admin_retention_plan_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PlanRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PlanResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/retention/purge": {
      "post": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Purge Admin",
        "operationId": "purge_admin_admin_retention_purge_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PurgeRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PurgeResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/retention/receipts": {
      "get": {
        "tags": [
          "admin-retention"
        ],
        "summary": "List Receipts Admin",
        "operationId": "list_receipts_admin_admin_retention_receipts_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Tenant"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "default": 50,
              "title": "Limit"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response List Receipts Admin Admin Retention Receipts Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/retention/receipts/{receipt_id}": {
      "get": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Get Receipt Admin",
        "operationId": "get_receipt_admin_admin_retention_receipts__receipt_id__get",
        "parameters": [
          {
            "name": "receipt_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Receipt Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Receipt Admin Admin Retention Receipts  Receipt Id  Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/retention/verify/{receipt_id}": {
      "post": {
        "tags": [
          "admin-retention"
        ],
        "summary": "Verify Receipt Admin",
        "operationId": "verify_receipt_admin_admin_retention_verify__receipt_id__post",
        "parameters": [
          {
            "name": "receipt_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Receipt Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "boolean"
                  },
                  "title": "Response Verify Receipt Admin Admin Retention Verify  Receipt Id  Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/decisions/export.ndjson": {
      "get": {
        "tags": [
          "admin-export"
        ],
        "summary": "Export Decisions Ndjson",
        "description": "Stream Decisions as NDJSON. Honors tenant, bot, since, until, outcome filters.\nContent-Type: application/x-ndjson",
        "operationId": "export_decisions_ndjson_admin_api_decisions_export_ndjson_get",
        "parameters": [
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch ms inclusive",
              "title": "Since"
            },
            "description": "Epoch ms inclusive"
          },
          {
            "name": "until",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch ms inclusive",
              "title": "Until"
            },
            "description": "Epoch ms inclusive"
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "allow|block|clarify|redact",
              "title": "Outcome"
            },
            "description": "allow|block|clarify|redact"
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/adjudications/export.ndjson": {
      "get": {
        "tags": [
          "admin-export"
        ],
        "summary": "Export Adjudications Ndjson",
        "description": "Stream Adjudications as NDJSON. Honors tenant, bot, since, until, outcome,\nrule_id, and request_id filters. Content-Type: application/x-ndjson",
        "operationId": "export_adjudications_ndjson_admin_api_adjudications_export_ndjson_get",
        "parameters": [
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch ms inclusive",
              "title": "Since"
            },
            "description": "Epoch ms inclusive"
          },
          {
            "name": "until",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "integer"
                },
                {
                  "type": "null"
                }
              ],
              "description": "Epoch ms inclusive",
              "title": "Until"
            },
            "description": "Epoch ms inclusive"
          },
          {
            "name": "outcome",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "description": "allow|block|clarify|redact",
              "title": "Outcome"
            },
            "description": "allow|block|clarify|redact"
          },
          {
            "name": "rule_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Rule Id"
            }
          },
          {
            "name": "request_id",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Request Id"
            }
          },
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/policy/version": {
      "get": {
        "summary": "Policy Version",
        "description": "Returns the active merged policy version and configured packs.",
        "operationId": "policy_version_admin_api_policy_version_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/api/policy/diff": {
      "get": {
        "summary": "Policy Diff",
        "description": "Read-only diff between the active policy and a merged candidate.",
        "operationId": "policy_diff_admin_api_policy_diff_get",
        "parameters": [
          {
            "name": "packs",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Packs"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/policy/reload": {
      "post": {
        "summary": "Policy Reload",
        "description": "Reload policy packs; returns the new version. CSRF-protected.\nPayload may include: {\"csrf_token\": \"...\"} for double-submit.",
        "operationId": "policy_reload_admin_api_policy_reload_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/policy/validate": {
      "post": {
        "summary": "Policy Validate",
        "operationId": "policy_validate_admin_api_policy_validate_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/mitigation_modes": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Read Mitigation Modes",
        "operationId": "read_mitigation_modes_admin_mitigation_modes_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "",
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "",
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin"
        ],
        "summary": "Write Mitigation Modes",
        "operationId": "write_mitigation_modes_admin_mitigation_modes_put",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "admin"
        ],
        "summary": "Remove Mitigation Modes",
        "operationId": "remove_mitigation_modes_admin_mitigation_modes_delete",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "",
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "default": "",
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/mitigation/modes": {
      "get": {
        "tags": [
          "admin-mitigation"
        ],
        "summary": "Get Modes",
        "operationId": "get_modes_admin_api_mitigation_modes_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/app__routes__admin_mitigation__ModeResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin-mitigation"
        ],
        "summary": "Put Modes",
        "operationId": "put_modes_admin_api_mitigation_modes_put",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModeReq"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/app__routes__admin_mitigation__ModeResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/mitigation-mode": {
      "get": {
        "tags": [
          "admin-mitigation"
        ],
        "summary": "Get Mode",
        "operationId": "get_mode_admin_api_mitigation_mode_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/app__routes__admin_mitigation_modes__ModeResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "admin-mitigation"
        ],
        "summary": "Put Mode",
        "operationId": "put_mode_admin_api_mitigation_mode_put",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PutReq"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/app__routes__admin_secrets_strict__OkResp"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/mitigation-modes": {
      "get": {
        "tags": [
          "admin-mitigation"
        ],
        "summary": "List Modes",
        "operationId": "list_modes_admin_api_mitigation_modes_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {
                    "$ref": "#/components/schemas/ListEntry"
                  },
                  "type": "array",
                  "title": "Response List Modes Admin Api Mitigation Modes Get"
                }
              }
            }
          }
        }
      }
    },
    "/admin/compliance/status": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Status",
        "operationId": "status_admin_compliance_status_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Status Admin Compliance Status Get"
                }
              }
            }
          }
        }
      }
    },
    "/admin/compliance/hash": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Do Hash",
        "operationId": "do_hash_admin_compliance_hash_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/HashIn"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Do Hash Admin Compliance Hash Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/quota/status": {
      "get": {
        "tags": [
          "admin-quota"
        ],
        "summary": "Quota Status",
        "operationId": "quota_status_admin_quota_status_get",
        "parameters": [
          {
            "name": "key",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string",
                  "minLength": 1
                },
                {
                  "type": "null"
                }
              ],
              "title": "Key"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Quota Status Admin Quota Status Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/quota/reset": {
      "post": {
        "tags": [
          "admin-quota"
        ],
        "summary": "Quota Reset",
        "operationId": "quota_reset_admin_quota_reset_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Quota Reset Admin Quota Reset Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/flags": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Get Flags",
        "operationId": "get_flags_admin_flags_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Get Flags Admin Flags Get"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Set Flags",
        "operationId": "set_flags_admin_flags_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Set Flags Admin Flags Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/snapshot": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Snapshot",
        "operationId": "snapshot_admin_snapshot_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Snapshot Admin Snapshot Get"
                }
              }
            }
          }
        }
      }
    },
    "/admin/threat/reload": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Reload Threat Feeds",
        "description": "Contract expected by tests:\n  200 OK with: {\"ok\": true, \"result\": {\"compiled\": <int>}}\nLoads rules from THREAT_FEED_URLS (comma-separated) using tf._fetch_json\nand activates them for dynamic redaction.",
        "operationId": "reload_threat_feeds_admin_threat_reload_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Reload Threat Feeds Admin Threat Reload Post"
                }
              }
            }
          }
        }
      }
    },
    "/admin/api/verifier/router/snapshot": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Verifier Router Snapshot",
        "description": "Expose the in-process router's last order snapshot.\nReturns an empty list if the router is not initialized or an error occurs.",
        "operationId": "verifier_router_snapshot_admin_api_verifier_router_snapshot_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "items": {},
                  "type": "array",
                  "title": "Response Verifier Router Snapshot Admin Api Verifier Router Snapshot Get"
                }
              }
            }
          }
        }
      }
    },
    "/guardrail/batch_evaluate": {
      "post": {
        "tags": [
          "guardrail"
        ],
        "summary": "Batch Evaluate",
        "description": "Evaluate multiple ingress texts in one request.\n\nPer-item:\n  - sanitize + optional threat feed redactions\n  - detectors\n  - optional verifier (feature gated via X-Force-Unclear: 1)\n  - audit + family metrics",
        "operationId": "batch_evaluate_guardrail_batch_evaluate_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          },
          {
            "name": "X-Force-Unclear",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Force-Unclear"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchIn"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/guardrail/egress_batch": {
      "post": {
        "tags": [
          "guardrail"
        ],
        "summary": "Egress Batch",
        "description": "Evaluate multiple egress texts in one request (post-model output).\n\nPer-item:\n  - hard-deny checks, else sanitize via policy.sanitize_text\n  - audit + family metrics",
        "operationId": "egress_batch_guardrail_egress_batch_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchIn"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/batch/egress_batch": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Egress Batch V1",
        "operationId": "egress_batch_v1_v1_batch_egress_batch_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchIn"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/batch/batch_evaluate": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Batch Evaluate V1",
        "operationId": "batch_evaluate_v1_v1_batch_batch_evaluate_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          },
          {
            "name": "X-Force-Unclear",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Force-Unclear"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchIn"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BatchOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/demo/egress_stream": {
      "get": {
        "summary": "Demo Egress Stream",
        "description": "Demo endpoint for the StreamingGuard. Splits `text` into `chunk`-sized\npieces and streams them, applying streaming redactions when enabled.",
        "operationId": "demo_egress_stream_demo_egress_stream_get",
        "parameters": [
          {
            "name": "text",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Text"
            }
          },
          {
            "name": "chunk",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 4096,
              "minimum": 1,
              "default": 8,
              "title": "Chunk"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/guardrail/": {
      "post": {
        "summary": "Guardrail Legacy",
        "operationId": "guardrail_legacy_guardrail__post",
        "parameters": [
          {
            "name": "x-api-key",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/guardrail": {
      "post": {
        "summary": "Guardrail Legacy",
        "operationId": "guardrail_legacy_guardrail_post",
        "parameters": [
          {
            "name": "x-api-key",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/guardrail/evaluate": {
      "post": {
        "summary": "Guardrail Evaluate",
        "operationId": "guardrail_evaluate_guardrail_evaluate_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/guardrail/evaluate_multipart": {
      "post": {
        "summary": "Guardrail Evaluate Multipart",
        "operationId": "guardrail_evaluate_multipart_guardrail_evaluate_multipart_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/guardrail/egress_evaluate": {
      "post": {
        "summary": "Guardrail Egress",
        "operationId": "guardrail_egress_guardrail_egress_evaluate_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/openai/deployments/{deployment_id}/chat/completions": {
      "post": {
        "tags": [
          "azure-openai-compat"
        ],
        "summary": "Azure Chat Completions",
        "description": "Azure-style chat endpoint. Delegates to /v1/chat/completions.",
        "operationId": "azure_chat_completions_openai_deployments__deployment_id__chat_completions_post",
        "parameters": [
          {
            "name": "deployment_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Deployment Id"
            }
          },
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/_AzureChatBody"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/openai/deployments/{deployment_id}/embeddings": {
      "post": {
        "tags": [
          "azure-openai-compat"
        ],
        "summary": "Azure Embeddings",
        "description": "Azure-style embeddings endpoint.",
        "operationId": "azure_embeddings_openai_deployments__deployment_id__embeddings_post",
        "parameters": [
          {
            "name": "deployment_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "title": "Deployment Id"
            }
          },
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/_AzureEmbeddingsBody"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/health": {
      "get": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Health",
        "operationId": "health_v1_health_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Health V1 Health Get"
                }
              }
            }
          }
        }
      }
    },
    "/v1/models": {
      "get": {
        "tags": [
          "openai-compat"
        ],
        "summary": "List Models",
        "operationId": "list_models_v1_models_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/chat/completions": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Chat Completions",
        "description": "OpenAI-compatible chat endpoint with inline guardrails and quotas.\nSupports non-streaming and streaming SSE (stream=true).",
        "operationId": "chat_completions_v1_chat_completions_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatCompletionsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/images/generations": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Images Generations",
        "description": "/v1/images/generations with quotas + guard.",
        "operationId": "images_generations_v1_images_generations_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ImagesGenerateRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Images Generations V1 Images Generations Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/images/edits": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Images Edits",
        "description": "/v1/images/edits with quotas + guard.",
        "operationId": "images_edits_v1_images_edits_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_images_edits_v1_images_edits_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Images Edits V1 Images Edits Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/images/variations": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Images Variations",
        "description": "/v1/images/variations with quotas + guard.",
        "operationId": "images_variations_v1_images_variations_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "$ref": "#/components/schemas/Body_images_variations_v1_images_variations_post"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Images Variations V1 Images Variations Post"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/moderations": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Create Moderation",
        "description": "/v1/moderations with quotas + guard.",
        "operationId": "create_moderation_v1_moderations_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ModerationsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/embeddings": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Create Embeddings",
        "description": "/v1/embeddings with quotas + guard.",
        "operationId": "create_embeddings_v1_embeddings_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmbeddingsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/completions": {
      "post": {
        "tags": [
          "openai-compat"
        ],
        "summary": "Completions",
        "description": "/v1/completions with quotas + guard.",
        "operationId": "completions_v1_completions_post",
        "parameters": [
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CompletionsRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/guardrail/output": {
      "post": {
        "tags": [
          "guardrail"
        ],
        "summary": "Guard Output",
        "description": "Egress filter:\n  - Enforce output size limit via OUTPUT_MAX_CHARS or settings.MAX_OUTPUT_CHARS.\n  - If REDACT_SECRETS=true, apply policy redactions.\n  - Always return decision=\"allow\" with required schema fields.\n  - Emit enriched enterprise audit + family metrics.",
        "operationId": "guard_output_guardrail_output_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/OutputGuardrailRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/GuardrailResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/proxy/chat": {
      "post": {
        "tags": [
          "proxy"
        ],
        "summary": "Proxy Chat",
        "description": "End-to-end guarded chat:\n  0) Require X-API-Key\n  1) Ingress sanitize + detect\n  2) If not denied, call provider (default: local echo)\n  3) Egress sanitize/deny\n  4) Emit enriched audit + metrics at each step",
        "operationId": "proxy_chat_proxy_chat_post",
        "parameters": [
          {
            "name": "X-API-Key",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          },
          {
            "name": "X-Debug",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Debug"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChatRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ChatResponse"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/stream/demo": {
      "get": {
        "summary": "Stream Demo",
        "operationId": "stream_demo_stream_demo_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/live": {
      "get": {
        "summary": "Live",
        "operationId": "live_live_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/ready": {
      "get": {
        "summary": "Ready",
        "operationId": "ready_ready_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/verifier/test": {
      "post": {
        "tags": [
          "verifier"
        ],
        "summary": "Verifier Test",
        "operationId": "verifier_test_verifier_test_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifierInput"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/version": {
      "get": {
        "tags": [
          "health"
        ],
        "summary": "Version",
        "operationId": "version_version_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "type": "object",
                  "title": "Response Version Version Get"
                }
              }
            }
          }
        }
      }
    },
    "/robots.txt": {
      "get": {
        "summary": "Robots Txt",
        "description": "Minimal robots.txt. Defaults to disallow /admin; override with ROBOTS_ALLOW\nand ROBOTS_DISALLOW (comma-separated absolute paths).",
        "operationId": "robots_txt_robots_txt_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/.well-known/security.txt": {
      "get": {
        "summary": "Security Txt",
        "description": "security.txt per RFC draft. Only served if SECURITY_CONTACT is set.\nOptional:\n  - SECURITY_POLICY\n  - SECURITY_ENCRYPTION\n  - SECURITY_ACKNOWLEDGEMENTS\n  - SECURITY_PREFERRED_LANG (e.g., \"en, fr\")",
        "operationId": "security_txt__well_known_security_txt_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/guardrail/": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Guardrail Legacy",
        "operationId": "guardrail_legacy_v1_guardrail__post",
        "parameters": [
          {
            "name": "x-api-key",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/guardrail": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Guardrail Legacy",
        "operationId": "guardrail_legacy_v1_guardrail_post",
        "parameters": [
          {
            "name": "x-api-key",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Api-Key"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Authorization"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/guardrail/evaluate": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Guardrail Evaluate",
        "operationId": "guardrail_evaluate_v1_guardrail_evaluate_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/guardrail/evaluate_multipart": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Guardrail Evaluate Multipart",
        "operationId": "guardrail_evaluate_multipart_v1_guardrail_evaluate_multipart_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/v1/guardrail/egress_evaluate": {
      "post": {
        "tags": [
          "guardrail",
          "v1"
        ],
        "summary": "Guardrail Egress",
        "operationId": "guardrail_egress_v1_guardrail_egress_evaluate_post",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    },
    "/admin/api/egress/incidents": {
      "get": {
        "summary": "Get Egress Incidents",
        "operationId": "get_egress_incidents_admin_api_egress_incidents_get",
        "parameters": [
          {
            "name": "X-Admin-Key",
            "in": "header",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "X-Admin-Key"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true,
                  "title": "Response Get Egress Incidents Admin Api Egress Incidents Get"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings/ui": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Bindings Ui",
        "operationId": "admin_bindings_ui_admin_bindings_ui_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        }
      }
    },
    "/admin/bindings/apply": {
      "post": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Bindings Apply",
        "description": "Accepts JSON payload:\n  {\"bindings\": [{\"tenant_id\": \"...\", \"bot_id\": \"...\", \"policy_version\": \"...\",\n                 \"priority\": 0, \"model\": null, \"source\": null}, ...]}",
        "operationId": "admin_bindings_apply_admin_bindings_apply_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "additionalProperties": true,
                "type": "object",
                "title": "Payload"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/active-policy": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Active Policy",
        "operationId": "admin_active_policy_admin_active_policy_get",
        "parameters": [
          {
            "name": "tenant",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Tenant"
            }
          },
          {
            "name": "bot",
            "in": "query",
            "required": false,
            "schema": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "null"
                }
              ],
              "title": "Bot"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/admin/metrics": {
      "get": {
        "tags": [
          "admin"
        ],
        "summary": "Admin Metrics",
        "operationId": "admin_metrics_admin_metrics_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "AuditItem": {
        "properties": {
          "ts_ms": {
            "type": "integer",
            "title": "Ts Ms"
          },
          "action": {
            "type": "string",
            "title": "Action"
          },
          "actor_email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Actor Email"
          },
          "actor_role": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Actor Role"
          },
          "tenant": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant"
          },
          "bot": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bot"
          },
          "outcome": {
            "type": "string",
            "title": "Outcome"
          },
          "meta": {
            "additionalProperties": true,
            "type": "object",
            "title": "Meta"
          }
        },
        "type": "object",
        "required": [
          "ts_ms",
          "action",
          "actor_email",
          "actor_role",
          "tenant",
          "bot",
          "outcome",
          "meta"
        ],
        "title": "AuditItem"
      },
      "BatchIn": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/BatchItemIn"
            },
            "type": "array",
            "title": "Items"
          }
        },
        "type": "object",
        "required": [
          "items"
        ],
        "title": "BatchIn"
      },
      "BatchItemIn": {
        "properties": {
          "text": {
            "type": "string",
            "title": "Text"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          }
        },
        "type": "object",
        "required": [
          "text"
        ],
        "title": "BatchItemIn"
      },
      "BatchItemOut": {
        "properties": {
          "request_id": {
            "type": "string",
            "title": "Request Id"
          },
          "action": {
            "type": "string",
            "title": "Action"
          },
          "text": {
            "type": "string",
            "title": "Text"
          },
          "transformed_text": {
            "type": "string",
            "title": "Transformed Text"
          },
          "risk_score": {
            "type": "integer",
            "title": "Risk Score"
          },
          "rule_hits": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rule Hits"
          },
          "redactions": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Redactions"
          },
          "decisions": {
            "anyOf": [
              {
                "items": {
                  "additionalProperties": true,
                  "type": "object"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Decisions"
          }
        },
        "type": "object",
        "required": [
          "request_id",
          "action",
          "text",
          "transformed_text",
          "risk_score"
        ],
        "title": "BatchItemOut"
      },
      "BatchOut": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/BatchItemOut"
            },
            "type": "array",
            "title": "Items"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "items",
          "count"
        ],
        "title": "BatchOut"
      },
      "BindingsResponse": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "bot": {
            "type": "string",
            "title": "Bot"
          },
          "policy_packs": {
            "items": {
              "$ref": "#/components/schemas/PolicyPackInfo"
            },
            "type": "array",
            "title": "Policy Packs"
          },
          "mitigation_overrides": {
            "additionalProperties": {
              "$ref": "#/components/schemas/MitigationOverrideInfo"
            },
            "type": "object",
            "title": "Mitigation Overrides"
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "bot",
          "policy_packs",
          "mitigation_overrides"
        ],
        "title": "BindingsResponse"
      },
      "Body_images_edits_v1_images_edits_post": {
        "properties": {
          "image": {
            "anyOf": [
              {
                "type": "string",
                "format": "binary"
              },
              {
                "type": "null"
              }
            ],
            "title": "Image"
          },
          "prompt": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Prompt",
            "default": ""
          },
          "n": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "N",
            "default": 1
          },
          "size": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Size",
            "default": "256x256"
          },
          "response_format": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Response Format",
            "default": "b64_json"
          }
        },
        "type": "object",
        "title": "Body_images_edits_v1_images_edits_post"
      },
      "Body_images_variations_v1_images_variations_post": {
        "properties": {
          "image": {
            "type": "string",
            "format": "binary",
            "title": "Image"
          },
          "n": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "N",
            "default": 1
          },
          "size": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Size",
            "default": "256x256"
          },
          "response_format": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Response Format",
            "default": "b64_json"
          },
          "prompt": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Prompt",
            "default": ""
          }
        },
        "type": "object",
        "required": [
          "image"
        ],
        "title": "Body_images_variations_v1_images_variations_post"
      },
      "Body_ui_reload_admin_ui_reload_post": {
        "properties": {
          "csrf_token": {
            "type": "string",
            "title": "Csrf Token"
          }
        },
        "type": "object",
        "required": [
          "csrf_token"
        ],
        "title": "Body_ui_reload_admin_ui_reload_post"
      },
      "ChatCompletionsRequest": {
        "properties": {
          "model": {
            "type": "string",
            "title": "Model"
          },
          "messages": {
            "items": {
              "$ref": "#/components/schemas/app__routes__openai_compat__ChatMessage"
            },
            "type": "array",
            "title": "Messages"
          },
          "stream": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stream",
            "default": false
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          }
        },
        "type": "object",
        "required": [
          "model",
          "messages"
        ],
        "title": "ChatCompletionsRequest"
      },
      "ChatRequest": {
        "properties": {
          "model": {
            "type": "string",
            "title": "Model"
          },
          "messages": {
            "items": {
              "$ref": "#/components/schemas/app__routes__openai_compat__ChatMessage"
            },
            "type": "array",
            "title": "Messages"
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          }
        },
        "type": "object",
        "required": [
          "model",
          "messages"
        ],
        "title": "ChatRequest"
      },
      "ChatResponse": {
        "properties": {
          "request_id": {
            "type": "string",
            "title": "Request Id"
          },
          "policy_version": {
            "type": "string",
            "title": "Policy Version"
          },
          "model": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Model"
          },
          "ingress": {
            "$ref": "#/components/schemas/IngressDecision"
          },
          "output_text": {
            "type": "string",
            "title": "Output Text"
          },
          "egress": {
            "$ref": "#/components/schemas/EgressDecision"
          }
        },
        "type": "object",
        "required": [
          "request_id",
          "policy_version",
          "model",
          "ingress",
          "output_text",
          "egress"
        ],
        "title": "ChatResponse"
      },
      "CompletionsRequest": {
        "properties": {
          "model": {
            "type": "string",
            "title": "Model"
          },
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "stream": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stream",
            "default": false
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          }
        },
        "type": "object",
        "required": [
          "model",
          "prompt"
        ],
        "title": "CompletionsRequest"
      },
      "DecisionItem": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id"
          },
          "ts": {
            "type": "string",
            "title": "Ts"
          },
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "bot": {
            "type": "string",
            "title": "Bot"
          },
          "outcome": {
            "type": "string",
            "title": "Outcome"
          },
          "policy_version": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Policy Version"
          },
          "rule_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rule Id"
          },
          "incident_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Incident Id"
          },
          "mode": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mode"
          },
          "details": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Details"
          }
        },
        "type": "object",
        "required": [
          "id",
          "ts",
          "tenant",
          "bot",
          "outcome"
        ],
        "title": "DecisionItem"
      },
      "DecisionPage": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/DecisionItem"
            },
            "type": "array",
            "title": "Items"
          },
          "page": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Page"
          },
          "page_size": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Page Size"
          },
          "has_more": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Has More"
          },
          "total": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Total"
          },
          "next_cursor": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Next Cursor"
          },
          "prev_cursor": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Prev Cursor"
          },
          "limit": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Limit"
          },
          "dir": {
            "anyOf": [
              {
                "type": "string",
                "enum": [
                  "next",
                  "prev"
                ]
              },
              {
                "type": "null"
              }
            ],
            "title": "Dir"
          }
        },
        "type": "object",
        "required": [
          "items"
        ],
        "title": "DecisionPage"
      },
      "DeleteRequest": {
        "properties": {
          "kinds": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Kinds"
          },
          "tenant": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant"
          },
          "bot": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bot"
          },
          "before_ts_ms": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Before Ts Ms",
            "description": "Delete records with ts_ms strictly before this value"
          },
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          }
        },
        "type": "object",
        "required": [
          "kinds",
          "before_ts_ms"
        ],
        "title": "DeleteRequest"
      },
      "DeleteResponse": {
        "properties": {
          "deleted": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Deleted"
          }
        },
        "type": "object",
        "required": [
          "deleted"
        ],
        "title": "DeleteResponse"
      },
      "DlqActResp": {
        "properties": {
          "requeued": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Requeued"
          },
          "deleted": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Deleted"
          }
        },
        "type": "object",
        "title": "DlqActResp"
      },
      "DlqActionRequest": {
        "properties": {
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          }
        },
        "type": "object",
        "title": "DlqActionRequest"
      },
      "DlqStats": {
        "properties": {
          "size": {
            "type": "integer",
            "title": "Size"
          },
          "oldest_ts_ms": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Oldest Ts Ms"
          },
          "newest_ts_ms": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Newest Ts Ms"
          },
          "last_error": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Last Error"
          }
        },
        "type": "object",
        "required": [
          "size"
        ],
        "title": "DlqStats"
      },
      "EffectiveScope": {
        "properties": {
          "effective_tenant": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            ],
            "title": "Effective Tenant"
          },
          "effective_bot": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            ],
            "title": "Effective Bot"
          }
        },
        "type": "object",
        "title": "EffectiveScope"
      },
      "EgressDecision": {
        "properties": {
          "action": {
            "type": "string",
            "title": "Action"
          },
          "text": {
            "type": "string",
            "title": "Text"
          },
          "rule_hits": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rule Hits"
          },
          "redactions": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Redactions"
          }
        },
        "type": "object",
        "required": [
          "action",
          "text"
        ],
        "title": "EgressDecision"
      },
      "EmbeddingsRequest": {
        "properties": {
          "model": {
            "type": "string",
            "title": "Model"
          },
          "input": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            ],
            "title": "Input"
          }
        },
        "type": "object",
        "required": [
          "model",
          "input"
        ],
        "title": "EmbeddingsRequest"
      },
      "ExecuteReq": {
        "properties": {
          "before_ts_ms": {
            "type": "integer",
            "title": "Before Ts Ms",
            "description": "Delete anything earlier than this epoch ms (exclusive)"
          },
          "tenant": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant"
          },
          "bot": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bot"
          },
          "confirm": {
            "type": "string",
            "title": "Confirm",
            "description": "Must be exactly \"DELETE\" to proceed"
          },
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          },
          "max_delete": {
            "type": "integer",
            "maximum": 50000.0,
            "minimum": 1.0,
            "title": "Max Delete",
            "description": "Upper bound on total records removed this request",
            "default": 50000
          }
        },
        "type": "object",
        "required": [
          "before_ts_ms",
          "confirm"
        ],
        "title": "ExecuteReq"
      },
      "ExecuteResp": {
        "properties": {
          "deleted": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Deleted"
          }
        },
        "type": "object",
        "required": [
          "deleted"
        ],
        "title": "ExecuteResp"
      },
      "FeaturesResp": {
        "properties": {
          "golden_one_click": {
            "type": "boolean",
            "title": "Golden One Click"
          }
        },
        "type": "object",
        "required": [
          "golden_one_click"
        ],
        "title": "FeaturesResp"
      },
      "GuardrailResponse": {
        "properties": {
          "request_id": {
            "type": "string",
            "title": "Request Id"
          },
          "decision": {
            "type": "string",
            "title": "Decision"
          },
          "reason": {
            "type": "string",
            "title": "Reason"
          },
          "rule_hits": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Rule Hits"
          },
          "policy_version": {
            "type": "string",
            "title": "Policy Version"
          },
          "transformed_text": {
            "type": "string",
            "title": "Transformed Text"
          }
        },
        "type": "object",
        "required": [
          "request_id",
          "decision",
          "reason",
          "rule_hits",
          "policy_version",
          "transformed_text"
        ],
        "title": "GuardrailResponse"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "HashIn": {
        "properties": {
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "phone": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Phone"
          },
          "text": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Text"
          }
        },
        "type": "object",
        "title": "HashIn"
      },
      "ImagesGenerateRequest": {
        "properties": {
          "model": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Model"
          },
          "prompt": {
            "type": "string",
            "title": "Prompt"
          },
          "n": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "N",
            "default": 1
          },
          "size": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Size",
            "default": "256x256"
          },
          "response_format": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Response Format",
            "default": "b64_json"
          },
          "user": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "User"
          }
        },
        "type": "object",
        "required": [
          "prompt"
        ],
        "title": "ImagesGenerateRequest"
      },
      "IngressDecision": {
        "properties": {
          "action": {
            "type": "string",
            "title": "Action"
          },
          "text": {
            "type": "string",
            "title": "Text"
          },
          "transformed_text": {
            "type": "string",
            "title": "Transformed Text"
          },
          "risk_score": {
            "type": "integer",
            "title": "Risk Score"
          },
          "rule_hits": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Rule Hits"
          },
          "redactions": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Redactions"
          }
        },
        "type": "object",
        "required": [
          "action",
          "text",
          "transformed_text",
          "risk_score"
        ],
        "title": "IngressDecision"
      },
      "ListEntry": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "bot": {
            "type": "string",
            "title": "Bot"
          },
          "mode": {
            "type": "string",
            "title": "Mode"
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "bot",
          "mode"
        ],
        "title": "ListEntry"
      },
      "MeResp": {
        "properties": {
          "authenticated": {
            "type": "boolean",
            "title": "Authenticated"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          },
          "name": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Name"
          },
          "role": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Role"
          }
        },
        "type": "object",
        "required": [
          "authenticated"
        ],
        "title": "MeResp"
      },
      "MitigationOverrideInfo": {
        "properties": {
          "enabled": {
            "type": "boolean",
            "title": "Enabled"
          },
          "last_modified": {
            "type": "integer",
            "title": "Last Modified"
          }
        },
        "type": "object",
        "required": [
          "enabled",
          "last_modified"
        ],
        "title": "MitigationOverrideInfo"
      },
      "MitigationTotals": {
        "properties": {
          "block": {
            "type": "integer",
            "title": "Block"
          },
          "clarify": {
            "type": "integer",
            "title": "Clarify"
          },
          "redact": {
            "type": "integer",
            "title": "Redact"
          }
        },
        "type": "object",
        "required": [
          "block",
          "clarify",
          "redact"
        ],
        "title": "MitigationTotals"
      },
      "ModeReq": {
        "properties": {
          "tenant": {
            "type": "string",
            "minLength": 1,
            "title": "Tenant"
          },
          "bot": {
            "type": "string",
            "minLength": 1,
            "title": "Bot"
          },
          "mode": {
            "type": "string",
            "title": "Mode"
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "bot",
          "mode"
        ],
        "title": "ModeReq"
      },
      "ModerationsRequest": {
        "properties": {
          "model": {
            "type": "string",
            "title": "Model"
          },
          "input": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              }
            ],
            "title": "Input"
          }
        },
        "type": "object",
        "required": [
          "model",
          "input"
        ],
        "title": "ModerationsRequest"
      },
      "OutputGuardrailRequest": {
        "properties": {
          "output": {
            "type": "string",
            "title": "Output"
          }
        },
        "type": "object",
        "required": [
          "output"
        ],
        "title": "OutputGuardrailRequest"
      },
      "OverridesResp": {
        "properties": {
          "totals": {
            "$ref": "#/components/schemas/MitigationTotals"
          },
          "since_ms": {
            "type": "integer",
            "title": "Since Ms"
          }
        },
        "type": "object",
        "required": [
          "totals",
          "since_ms"
        ],
        "title": "OverridesResp"
      },
      "PackItem": {
        "properties": {
          "id": {
            "type": "string",
            "title": "Id"
          },
          "version": {
            "type": "string",
            "title": "Version"
          },
          "source": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Source"
          },
          "scope": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Scope"
          },
          "rules_total": {
            "type": "integer",
            "title": "Rules Total",
            "default": 0
          },
          "rules_redact": {
            "type": "integer",
            "title": "Rules Redact",
            "default": 0
          }
        },
        "type": "object",
        "required": [
          "id",
          "version"
        ],
        "title": "PackItem"
      },
      "PackList": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/PackItem"
            },
            "type": "array",
            "title": "Items"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total"
        ],
        "title": "PackList"
      },
      "PlanRequest": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "resource": {
            "type": "string",
            "title": "Resource"
          },
          "limit": {
            "type": "integer",
            "maximum": 100.0,
            "minimum": 1.0,
            "title": "Limit",
            "default": 100
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "resource"
        ],
        "title": "PlanRequest"
      },
      "PlanResponse": {
        "properties": {
          "ids": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Ids"
          },
          "count": {
            "type": "integer",
            "title": "Count"
          }
        },
        "type": "object",
        "required": [
          "ids",
          "count"
        ],
        "title": "PlanResponse"
      },
      "PolicyPackInfo": {
        "properties": {
          "name": {
            "type": "string",
            "title": "Name"
          },
          "source": {
            "type": "string",
            "title": "Source"
          },
          "version": {
            "type": "string",
            "title": "Version"
          }
        },
        "type": "object",
        "required": [
          "name",
          "source",
          "version"
        ],
        "title": "PolicyPackInfo"
      },
      "PolicyPayload": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "resource": {
            "type": "string",
            "title": "Resource"
          },
          "ttl_seconds": {
            "type": "integer",
            "minimum": 0.0,
            "title": "Ttl Seconds"
          },
          "enabled": {
            "type": "boolean",
            "title": "Enabled",
            "default": true
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "resource",
          "ttl_seconds"
        ],
        "title": "PolicyPayload"
      },
      "PreviewReq": {
        "properties": {
          "before_ts_ms": {
            "type": "integer",
            "title": "Before Ts Ms",
            "description": "Delete anything earlier than this epoch ms (exclusive)"
          },
          "tenant": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Tenant"
          },
          "bot": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Bot"
          }
        },
        "type": "object",
        "required": [
          "before_ts_ms"
        ],
        "title": "PreviewReq"
      },
      "PreviewResp": {
        "properties": {
          "before_ts_ms": {
            "type": "integer",
            "title": "Before Ts Ms"
          },
          "decisions": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Decisions"
          },
          "adjudications": {
            "additionalProperties": {
              "type": "integer"
            },
            "type": "object",
            "title": "Adjudications"
          }
        },
        "type": "object",
        "required": [
          "before_ts_ms",
          "decisions",
          "adjudications"
        ],
        "title": "PreviewResp"
      },
      "PurgeRequest": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "resource": {
            "type": "string",
            "title": "Resource"
          },
          "ids": {
            "anyOf": [
              {
                "items": {
                  "type": "string"
                },
                "type": "array"
              },
              {
                "type": "null"
              }
            ],
            "title": "Ids"
          },
          "limit": {
            "anyOf": [
              {
                "type": "integer",
                "maximum": 100.0,
                "minimum": 1.0
              },
              {
                "type": "null"
              }
            ],
            "title": "Limit"
          },
          "dry_run": {
            "type": "boolean",
            "title": "Dry Run",
            "default": false
          },
          "actor": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Actor"
          },
          "mode": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mode"
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "resource"
        ],
        "title": "PurgeRequest"
      },
      "PurgeResponse": {
        "properties": {
          "receipt": {
            "additionalProperties": true,
            "type": "object",
            "title": "Receipt"
          },
          "signature": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "title": "Signature"
          }
        },
        "type": "object",
        "required": [
          "receipt",
          "signature"
        ],
        "title": "PurgeResponse"
      },
      "PutReq": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "bot": {
            "type": "string",
            "title": "Bot"
          },
          "mode": {
            "type": "string",
            "title": "Mode"
          },
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "bot",
          "mode"
        ],
        "title": "PutReq"
      },
      "SecretsResponse": {
        "properties": {
          "secret_sets": {
            "items": {
              "type": "string"
            },
            "type": "array",
            "title": "Secret Sets"
          }
        },
        "type": "object",
        "required": [
          "secret_sets"
        ],
        "title": "SecretsResponse"
      },
      "StrictResp": {
        "properties": {
          "enabled": {
            "type": "boolean",
            "title": "Enabled"
          }
        },
        "type": "object",
        "required": [
          "enabled"
        ],
        "title": "StrictResp"
      },
      "StrictSetReq": {
        "properties": {
          "tenant": {
            "type": "string",
            "title": "Tenant"
          },
          "bot": {
            "type": "string",
            "title": "Bot"
          },
          "enabled": {
            "type": "boolean",
            "title": "Enabled"
          },
          "csrf_token": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Csrf Token"
          }
        },
        "type": "object",
        "required": [
          "tenant",
          "bot",
          "enabled"
        ],
        "title": "StrictSetReq"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      },
      "VerifierInput": {
        "properties": {
          "text": {
            "type": "string",
            "title": "Text"
          },
          "modality": {
            "type": "string",
            "title": "Modality",
            "default": "text"
          },
          "rule_hits": {
            "additionalProperties": true,
            "type": "object",
            "title": "Rule Hits"
          },
          "context": {
            "anyOf": [
              {
                "additionalProperties": true,
                "type": "object"
              },
              {
                "type": "null"
              }
            ],
            "title": "Context"
          }
        },
        "type": "object",
        "required": [
          "text"
        ],
        "title": "VerifierInput"
      },
      "_AzureChatBody": {
        "properties": {
          "messages": {
            "items": {
              "$ref": "#/components/schemas/app__routes__openai_compat__ChatMessage"
            },
            "type": "array",
            "title": "Messages"
          },
          "stream": {
            "anyOf": [
              {
                "type": "boolean"
              },
              {
                "type": "null"
              }
            ],
            "title": "Stream",
            "default": false
          },
          "request_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Request Id"
          }
        },
        "type": "object",
        "required": [
          "messages"
        ],
        "title": "_AzureChatBody"
      },
      "_AzureEmbeddingsBody": {
        "properties": {
          "input": {
            "title": "Input"
          }
        },
        "type": "object",
        "required": [
          "input"
        ],
        "title": "_AzureEmbeddingsBody"
      },
      "app__routes__admin_mitigation__ModeResp": {
        "properties": {
          "mode": {
            "type": "string",
            "enum": [
              "block",
              "clarify",
              "redact"
            ],
            "title": "Mode"
          },
          "source": {
            "type": "string",
            "enum": [
              "explicit",
              "default"
            ],
            "title": "Source"
          }
        },
        "type": "object",
        "required": [
          "mode",
          "source"
        ],
        "title": "ModeResp"
      },
      "app__routes__admin_mitigation_modes__ModeResp": {
        "properties": {
          "mode": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Mode"
          },
          "source": {
            "type": "string",
            "title": "Source"
          }
        },
        "type": "object",
        "required": [
          "mode",
          "source"
        ],
        "title": "ModeResp"
      },
      "app__routes__admin_secrets_strict__OkResp": {
        "properties": {
          "ok": {
            "type": "boolean",
            "title": "Ok"
          }
        },
        "type": "object",
        "required": [
          "ok"
        ],
        "title": "OkResp"
      },
      "app__routes__openai_compat__ChatMessage": {
        "properties": {
          "role": {
            "type": "string",
            "pattern": "^(system|user|assistant)$",
            "title": "Role"
          },
          "content": {
            "type": "string",
            "title": "Content"
          }
        },
        "type": "object",
        "required": [
          "role",
          "content"
        ],
        "title": "ChatMessage"
      },
      "fastapi___compat__v2__Body_webhooks_replay_admin_api_webhooks_replay_post": {
        "properties": {
          "max_batch": {
            "type": "integer",
            "maximum": 1000.0,
            "minimum": 1.0,
            "title": "Max Batch",
            "default": 100
          },
          "since_seconds": {
            "anyOf": [
              {
                "type": "integer"
              },
              {
                "type": "null"
              }
            ],
            "title": "Since Seconds"
          },
          "dry_run": {
            "type": "boolean",
            "title": "Dry Run",
            "default": false
          }
        },
        "type": "object",
        "title": "Body_webhooks_replay_admin_api_webhooks_replay_post"
      }
    }
  },
  "tags": [
    {
      "name": "health",
      "description": "Liveness and readiness probes"
    },
    {
      "name": "decisions",
      "description": "Decision listing and exports"
    },
    {
      "name": "adjudications",
      "description": "Adjudication listing and exports"
    },
    {
      "name": "admin",
      "description": "Admin operations (CSRF-protected)"
    }
  ]
}