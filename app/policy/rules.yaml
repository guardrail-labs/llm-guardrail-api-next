version: 3
description: "Guardrail rules for prompt injection, secrets, and encoded blobs; v3 adds redaction behavior."
rules:
  - id: "pi:prompt_injection"
    category: "prompt_injection"
    severity: "high"
    examples:
      - "ignore previous instructions"
      - "reveal system prompt"

  - id: "secrets:api_key_like"
    category: "secrets"
    severity: "high"
    examples:
      - "sk-..."
      - "AKIA..."
      - "-----BEGIN PRIVATE KEY-----"

  - id: "payload:encoded_blob"
    category: "payload"
    severity: "high"
    examples:
      - "long base64/hex blob"

# deny:
#   - id: block_phrase
#     pattern: "(?i)do not allow this"
#     flags: ["i"]   # i=IGNORECASE, m=MULTILINE, s=DOTALL
