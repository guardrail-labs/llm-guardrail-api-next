# =============================================================================
# LLM Guardrail API — .env.example  (core: llm-guardrail-api-next)
# =============================================================================
# Copy to `.env` for local runs and CI. Values here are safe defaults.
# Only set provider keys (OPENAI_API_KEY, etc.) in secure envs.
# =============================================================================

# -----------------------------
# App & Server
# -----------------------------
APP_NAME=llm-guardrail-api
ENV=development
HOST=0.0.0.0
PORT=8000

# -----------------------------
# Logging & Metrics
# -----------------------------
LOG_LEVEL=INFO
METRICS_ENABLED=true
# If using Prometheus multiprocess (gunicorn, etc.)
PROMETHEUS_MULTIPROC_DIR=/tmp/prom

# -----------------------------
# Debug & Trace
# -----------------------------
# Enables structured debug breadcrumbs (e.g., debug.sources). Safe in dev.
DEBUG_HEADERS_ENABLED=true

# -----------------------------
# Policy / Rules
# -----------------------------
# Path may be ignored if the app loads internal defaults; safe to keep.
RULES_FILE=rules.yaml

# -----------------------------
# Threat Feed (optional; defaults off)
# -----------------------------
THREAT_FEED_ENABLED=false
# THREAT_FEED_URL=
# THREAT_FEED_AUTH_HEADER=

# -----------------------------
# Ingress Detectors & Sanitizers
# -----------------------------
# PR1: PDF hidden/transparent text detector (defaults ON)
PDF_DETECTOR_ENABLED=true

# -----------------------------
# Verifier Subsystem (assess-only)
# -----------------------------
# PR2: OpenAI adapter scaffold (no network calls unless you set a real key)
VERIFIER_PROVIDER=openai
VERIFIER_OPENAI_MODEL=gpt-4o-mini
VERIFIER_TIMEOUT_S=6.0
VERIFIER_RETRIES=1

# Provider keys — leave blank in CI; set securely in prod if you enable calls
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
# Azure OpenAI (if you wire an Azure adapter later)
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_VERSION=2024-06-01

# -----------------------------
# Quotas (optional; safe defaults)
# -----------------------------
QUOTAS_ENABLED=false
QUOTA_REQUESTS_PER_MIN=120
QUOTA_TOKENS_PER_MIN=60000

# -----------------------------
# Audit & Forwarding
# -----------------------------
# Where to send decision logs: stdout (default) or webhook
AUDIT_SINK=stdout        # stdout|webhook
AUDIT_WEBHOOK_URL=
AUDIT_WEBHOOK_AUTH_HEADER=

# -----------------------------
# OpenAI-Compatible Routes (proxy surface)
# -----------------------------
# These are for the compatibility endpoints the API exposes.
# You typically do NOT need these unless proxying upstream calls.
OPENAI_COMPAT_ENABLED=true
OPENAI_COMPAT_MAX_TOKENS=4096

# -----------------------------
# Misc
# -----------------------------
# CORS origins for local dev; adjust as needed
CORS_ALLOW_ORIGINS=*
# Abuse control defaults (window/tiers tuned for safety)
ABUSE_STRIKE_WINDOW_SEC=600
ABUSE_TIER1_THRESHOLD=3
ABUSE_TIER1_MODE=execute_locked
ABUSE_TIER1_COOLDOWN_SEC=3600
ABUSE_TIER2_THRESHOLD=5
ABUSE_TIER2_MODE=full_quarantine
ABUSE_TIER2_COOLDOWN_SEC=21600

# -----------------------------
# Rate Limiting
# -----------------------------
RATE_LIMIT_ENABLED=true
RATE_LIMIT_PER_API_KEY_PER_MIN=60
RATE_LIMIT_PER_IP_PER_MIN=120

# Document/image ingress wiring (default ON)
DOCX_DETECTOR_ENABLED=true
IMAGE_SAFE_TRANSFORM_ENABLED=true
